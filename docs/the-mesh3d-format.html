<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 The mesh3d format | Computational graphics structures for geo-spatial data</title>
  <meta name="description" content="Converting geo-spatial data into meshes suitable for computational graphics systems." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 The mesh3d format | Computational graphics structures for geo-spatial data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Converting geo-spatial data into meshes suitable for computational graphics systems." />
  <meta name="github-repo" content="mdsumner/geo-comp-graphics-oghub" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 The mesh3d format | Computational graphics structures for geo-spatial data" />
  
  <meta name="twitter:description" content="Converting geo-spatial data into meshes suitable for computational graphics systems." />
  

<meta name="author" content="Michael Sumner" />


<meta name="date" content="2019-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="d-and-mesh-forms-of-spatial-data.html"/>
<link rel="next" href="transforming-spatial-data-to-3d-forms.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/rglwidgetClass-2/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-2/rglClass.src.js"></script>
<script src="libs/CanvasMatrix4-2016/CanvasMatrix.src.js"></script>
<script src="libs/rglWebGL-binding-0.100.30/rglWebGL.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational graphics structures for geo-spatial data inR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#description-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Description and objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>2</b> Getting Set Up</a></li>
<li class="chapter" data-level="3" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html"><i class="fa fa-check"></i><b>3</b> 3D and mesh forms of spatial data</a><ul>
<li class="chapter" data-level="3.1" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#questions"><i class="fa fa-check"></i><b>3.1</b> Questions</a></li>
<li class="chapter" data-level="3.2" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#what-is-a-mesh"><i class="fa fa-check"></i><b>3.2</b> What is a mesh?</a></li>
<li class="chapter" data-level="3.3" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#geospatial-data"><i class="fa fa-check"></i><b>3.3</b> Geospatial data</a></li>
<li class="chapter" data-level="3.4" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#primitives"><i class="fa fa-check"></i><b>3.4</b> Primitives</a></li>
<li class="chapter" data-level="3.5" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#a-raster-is-a-mesh-implicitly"><i class="fa fa-check"></i><b>3.5</b> A raster is a mesh (implicitly)</a></li>
<li class="chapter" data-level="3.6" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#summary"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html"><i class="fa fa-check"></i><b>4</b> The mesh3d format</a><ul>
<li class="chapter" data-level="4.1" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#quads"><i class="fa fa-check"></i><b>4.1</b> Quads</a></li>
<li class="chapter" data-level="4.2" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#triangles"><i class="fa fa-check"></i><b>4.2</b> Triangles</a></li>
<li class="chapter" data-level="4.3" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#d-polygons"><i class="fa fa-check"></i><b>4.3</b> 3D polygons</a></li>
<li class="chapter" data-level="4.4" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#rgl-miscellanea"><i class="fa fa-check"></i><b>4.4</b> rgl miscellanea</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html"><i class="fa fa-check"></i><b>5</b> Transforming spatial data to 3D forms</a><ul>
<li class="chapter" data-level="5.1" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#algorithms"><i class="fa fa-check"></i><b>5.1</b> Algorithms</a></li>
<li class="chapter" data-level="5.2" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#raster"><i class="fa fa-check"></i><b>5.2</b> raster</a></li>
<li class="chapter" data-level="5.3" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#vector"><i class="fa fa-check"></i><b>5.3</b> vector</a></li>
<li class="chapter" data-level="5.4" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#image-textures"><i class="fa fa-check"></i><b>5.4</b> Image textures</a></li>
<li class="chapter" data-level="5.5" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#various-tools"><i class="fa fa-check"></i><b>5.5</b> Various tools</a></li>
<li class="chapter" data-level="5.6" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#triangles-or-quads-from-geospatial"><i class="fa fa-check"></i><b>5.6</b> Triangles or quads from geospatial</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html"><i class="fa fa-check"></i><b>6</b> Examples and exercises</a></li>
<li class="chapter" data-level="7" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>7</b> Exercise 1</a><ul>
<li class="chapter" data-level="7.0.1" data-path="exercise-1.html"><a href="exercise-1.html#ex-1-answer"><i class="fa fa-check"></i><b>7.0.1</b> EX 1 ANSWER</a></li>
<li class="chapter" data-level="7.1" data-path="exercise-1.html"><a href="exercise-1.html#exercise-2"><i class="fa fa-check"></i><b>7.1</b> Exercise 2</a><ul>
<li class="chapter" data-level="7.1.1" data-path="exercise-1.html"><a href="exercise-1.html#ex-2-answer"><i class="fa fa-check"></i><b>7.1.1</b> EX 2 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="exercise-1.html"><a href="exercise-1.html#exercise-3"><i class="fa fa-check"></i><b>7.2</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>8</b> Examples</a><ul>
<li class="chapter" data-level="8.1" data-path="examples.html"><a href="examples.html#quadmesh"><i class="fa fa-check"></i><b>8.1</b> Quadmesh</a></li>
<li class="chapter" data-level="8.2" data-path="examples.html"><a href="examples.html#polygon-triangulation"><i class="fa fa-check"></i><b>8.2</b> Polygon triangulation</a></li>
<li class="chapter" data-level="8.3" data-path="examples.html"><a href="examples.html#coordinate-systems-and-textures"><i class="fa fa-check"></i><b>8.3</b> Coordinate systems and textures</a></li>
<li class="chapter" data-level="8.4" data-path="examples.html"><a href="examples.html#try-with-own-data"><i class="fa fa-check"></i><b>8.4</b> Try with own data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/mdsumner/geo-comp-graphics-oghub" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational graphics structures for geo-spatial data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-mesh3d-format" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> The mesh3d format</h1>
<p>Rgl is the OpenGL package in R.</p>
<p>A classic <strong>computer graphics</strong> data model called <em>mesh3d</em>, it’s not widely used but is very powerful. You can visualize a <code>mesh3d</code> model with <code>shade3d()</code>, all the aesthetics, material properties, geometry and topology can be attached to the model
itself as data.</p>
<p>It supports two kinds of primitives <strong>quads</strong> and <strong>triangles</strong>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;geo-comp-graphics.Rdata&quot;</span>)</a></code></pre></div>
<div id="quads" class="section level2">
<h2><span class="header-section-number">4.1</span> Quads</h2>
<p>Quads are a funny case, usually carried by two triangles (at least implicitly) but they are an important computer graphics element.</p>
<p>Previously, we created a raster with effectively the following code.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dt">length =</span> <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb29-2" data-line-number="2">            <span class="kw">seq</span>(<span class="fl">0.375</span>, <span class="dv">0</span>, <span class="dt">length =</span> <span class="dv">4</span>)), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(m)) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">ncol</span>(m)) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6">rast &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> m))</a></code></pre></div>
<p>If we convert that to a quadmesh, the result has vertices (<code>vb</code>) and primitives (<code>ib</code>).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">library</span>(quadmesh)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">qm &lt;-<span class="st"> </span><span class="kw">quadmesh</span>(rast)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">str</span>(qm)</a></code></pre></div>
<pre><code>## List of 8
##  $ vb             : num [1:4, 1:16] 0 3 0.312 1 1 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:4] &quot;x&quot; &quot;y&quot; &quot;z&quot; &quot;1&quot;
##   .. ..$ : NULL
##  $ ib             : int [1:4, 1:9] 1 2 6 5 2 3 7 6 3 4 ...
##  $ primitivetype  : chr &quot;quad&quot;
##  $ material       : list()
##  $ normals        : NULL
##  $ texcoords      : NULL
##  $ raster_metadata:List of 7
##   ..$ xmn  : num 0
##   ..$ xmx  : num 3
##   ..$ ymn  : num 0
##   ..$ ymx  : num 3
##   ..$ ncols: int 3
##   ..$ nrows: int 3
##   ..$ crs  : chr &quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;
##  $ crs            : chr &quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;
##  - attr(*, &quot;class&quot;)= chr [1:3] &quot;quadmesh&quot; &quot;mesh3d&quot; &quot;shape3d&quot;</code></pre>
<p>The structure is <code>vb</code>, the coordinates of the mesh - these are the
actual corner coordinates from the input raster.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">image</span>(rast, <span class="dt">col =</span> <span class="kw">colpal</span>())</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">xpd =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="kw">text</span>(<span class="kw">t</span>(qm<span class="op">$</span>vb), <span class="dt">lab =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(qm<span class="op">$</span>vb))</a></code></pre></div>
<p><img src="geo-comp-graphics_files/figure-html/raster-image-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">par</span>(op)</a></code></pre></div>
<p>Notice how these are unique coordinates, there’s no simple relationship between the cell and its value and its four corners. This is because they are shared between neighbouring cells. The relationship is stored in the <code>ib</code> array, this has four rows one for each corner of each cell. There are 9 cells and each has four coordinates from the shared vertex pool. The cells are defined in the order they occur in raster.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">qm<span class="op">$</span>ib</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## [1,]    1    2    3    5    6    7    9   10   11
## [2,]    2    3    4    6    7    8   10   11   12
## [3,]    6    7    8   10   11   12   14   15   16
## [4,]    5    6    7    9   10   11   13   14   15</code></pre>
<p>It works directly with rgl function, and can be used in more raw form.</p>
<p>They key point in these plots is that with the exact same 3D geometry, we have the choice of how each primitive is styled. The colour may be a constant every where, or it may vary continously everywhere between vertices. A final choice is that the colour is constant <em>within a primitive</em>. No R 2D plot can easily do the <em>continuous texture</em> styling. This also applies to other kinds of textures, later we will apply an image texture to primitives.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="co">#clear3d()</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="kw">shade3d</span>(qm, <span class="dt">col =</span> <span class="st">&quot;firebrick&quot;</span>)</a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="kw">rglwidget</span>(<span class="dt">reuse =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div id="rgl47686" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl47686">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"43":{"id":43,"type":"quads","material":{},"vertices":[[0,3,0.312375098466873],[1,3,0.062583327293396],[1,2,0.312541663646698],[0,2,0.312500029802322],[1,3,0.062583327293396],[2,3,-0.124791741371155],[2,2,0.250083297491074],[1,2,0.312541663646698],[2,3,-0.124791741371155],[3,3,-0.249750077724457],[3,2,0.125124961137772],[2,2,0.250083297491074],[0,2,0.312500029802322],[1,2,0.312541663646698],[1,1,0.250083297491074],[0,1,0.125124961137772],[1,2,0.312541663646698],[2,2,0.250083297491074],[2,1,0.312541663646698],[1,1,0.250083297491074],[2,2,0.250083297491074],[3,2,0.125124961137772],[3,1,0.312500029802322],[2,1,0.312541663646698],[0,1,0.125124961137772],[1,1,0.250083297491074],[1,0,-0.124791741371155],[0,0,-0.249750077724457],[1,1,0.250083297491074],[2,1,0.312541663646698],[2,0,0.062583327293396],[1,0,-0.124791741371155],[2,1,0.312541663646698],[3,1,0.312500029802322],[3,0,0.312375098466873],[2,0,0.062583327293396]],"normals":[[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1]],"colors":[[0.69803923368454,0.133333340287209,0.133333340287209,1]],"centers":[[0.5,2.5,0.250000029802322],[1.5,2.5,0.125104129314423],[2.5,2.5,0.000166609883308411],[0.5,1.5,0.250062495470047],[1.5,1.5,0.281312465667725],[2.5,1.5,0.250062465667725],[0.5,0.5,0.000166609883308411],[1.5,0.5,0.125104129314423],[2.5,0.5,0.250000029802322]],"ignoreExtent":false,"flags":3},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{"fog":true},"colors":[[0.298039227724075,0.298039227724075,0.298039227724075,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,8.267822265625],"modelMatrix":[[1,0,0,-1.5],[0,0.342020153999329,0.939692616462708,-0.542532622814178],[0,-0.939692616462708,0.342020153999329,-6.86902141571045],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370372772217,-29.8045463562012],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,3,0,3,-0.249750077724457,0.312541663646698],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,43,5],"subscenes":[],"flags":515},"50":{"id":50,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":50,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143208,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143208,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1],[0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.58793780120968,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.58793780120968,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517866,-0.38268343236509,-0.375330277517866,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0.137949689641472,0.270598050073098,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073098,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]],"meshColor":"vertices"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">quads3d</span>(<span class="kw">t</span>(qm<span class="op">$</span>vb)[qm<span class="op">$</span>ib,], <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>)[qm<span class="op">$</span>ib <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl26075" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl26075">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"51":{"id":51,"type":"quads","material":{},"vertices":[[0,3,0.312375098466873],[1,3,0.062583327293396],[1,2,0.312541663646698],[0,2,0.312500029802322],[1,3,0.062583327293396],[2,3,-0.124791741371155],[2,2,0.250083297491074],[1,2,0.312541663646698],[2,3,-0.124791741371155],[3,3,-0.249750077724457],[3,2,0.125124961137772],[2,2,0.250083297491074],[0,2,0.312500029802322],[1,2,0.312541663646698],[1,1,0.250083297491074],[0,1,0.125124961137772],[1,2,0.312541663646698],[2,2,0.250083297491074],[2,1,0.312541663646698],[1,1,0.250083297491074],[2,2,0.250083297491074],[3,2,0.125124961137772],[3,1,0.312500029802322],[2,1,0.312541663646698],[0,1,0.125124961137772],[1,1,0.250083297491074],[1,0,-0.124791741371155],[0,0,-0.249750077724457],[1,1,0.250083297491074],[2,1,0.312541663646698],[2,0,0.062583327293396],[1,0,-0.124791741371155],[2,1,0.312541663646698],[3,1,0.312500029802322],[3,0,0.312375098466873],[2,0,0.062583327293396]],"normals":[[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1]],"colors":[[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1]],"centers":[[0.5,2.5,0.250000029802322],[1.5,2.5,0.125104129314423],[2.5,2.5,0.000166609883308411],[0.5,1.5,0.250062495470047],[1.5,1.5,0.281312465667725],[2.5,1.5,0.250062465667725],[0.5,0.5,0.000166609883308411],[1.5,0.5,0.125104129314423],[2.5,0.5,0.250000029802322]],"ignoreExtent":false,"flags":3},"5":{"id":5,"reuse":"rgl47686"},"4":{"id":4,"reuse":"rgl47686"},"6":{"id":6,"reuse":"rgl47686"},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,8.267822265625],"modelMatrix":[[1,0,0,-1.5],[0,0.342020153999329,0.939692616462708,-0.542532622814178],[0,-0.939692616462708,0.342020153999329,-6.86902141571045],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370372772217,-29.8045463562012],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,3,0,3,-0.249750077724457,0.312541663646698],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,51,5],"subscenes":[],"flags":515},"58":{"id":58,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":58,"sphereVerts":{"reuse":"rgl47686"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">quads3d</span>(<span class="kw">t</span>(qm<span class="op">$</span>vb)[qm<span class="op">$</span>ib,], <span class="dt">col =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>), <span class="dt">each =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl8873" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl8873">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"59":{"id":59,"type":"quads","material":{},"vertices":[[0,3,0.312375098466873],[1,3,0.062583327293396],[1,2,0.312541663646698],[0,2,0.312500029802322],[1,3,0.062583327293396],[2,3,-0.124791741371155],[2,2,0.250083297491074],[1,2,0.312541663646698],[2,3,-0.124791741371155],[3,3,-0.249750077724457],[3,2,0.125124961137772],[2,2,0.250083297491074],[0,2,0.312500029802322],[1,2,0.312541663646698],[1,1,0.250083297491074],[0,1,0.125124961137772],[1,2,0.312541663646698],[2,2,0.250083297491074],[2,1,0.312541663646698],[1,1,0.250083297491074],[2,2,0.250083297491074],[3,2,0.125124961137772],[3,1,0.312500029802322],[2,1,0.312541663646698],[0,1,0.125124961137772],[1,1,0.250083297491074],[1,0,-0.124791741371155],[0,0,-0.249750077724457],[1,1,0.250083297491074],[2,1,0.312541663646698],[2,0,0.062583327293396],[1,0,-0.124791741371155],[2,1,0.312541663646698],[3,1,0.312500029802322],[3,0,0.312375098466873],[2,0,0.062583327293396]],"normals":[[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.235519021749496,-0.23567607998848,-0.942861437797546],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.172812253236771,-0.34573969244957,-0.922279834747314],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[-0.116214118897915,-0.348642379045486,-0.930022954940796],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[4.15528738813009e-05,0.0623368993401527,-0.998055219650269],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.0622161254286766,-0.0622161254286766,-0.99612158536911],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[-0.121904835104942,-0.182796344161034,-0.975563824176788],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.116214118897915,0.348642379045486,-0.930022954940796],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[0.0604831725358963,0.242053613066673,-0.968375861644745],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1],[-4.16338443756104e-05,0.000124931335449219,-1]],"colors":[[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.117647059261799,0.564705908298492,1,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1],[0.69803923368454,0.133333340287209,0.133333340287209,1]],"centers":[[0.5,2.5,0.250000029802322],[1.5,2.5,0.125104129314423],[2.5,2.5,0.000166609883308411],[0.5,1.5,0.250062495470047],[1.5,1.5,0.281312465667725],[2.5,1.5,0.250062465667725],[0.5,0.5,0.000166609883308411],[1.5,0.5,0.125104129314423],[2.5,0.5,0.250000029802322]],"ignoreExtent":false,"flags":3},"5":{"id":5,"reuse":"rgl47686"},"4":{"id":4,"reuse":"rgl47686"},"6":{"id":6,"reuse":"rgl47686"},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,8.267822265625],"modelMatrix":[[1,0,0,-1.5],[0,0.342020153999329,0.939692616462708,-0.542532622814178],[0,-0.939692616462708,0.342020153999329,-6.86902141571045],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370372772217,-29.8045463562012],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,3,0,3,-0.249750077724457,0.312541663646698],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,59,5],"subscenes":[],"flags":515},"66":{"id":66,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":66,"sphereVerts":{"reuse":"rgl47686"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<p>The situation for triangles is much the same, but we have <code>it</code> for the triangle index rather than <code>ib</code> for the quad index. In both cases the geometry is in the <code>vb</code> matrix. Models can have both quads and triangles, using the same set of vertices.</p>
</div>
<div id="triangles" class="section level2">
<h2><span class="header-section-number">4.2</span> Triangles</h2>
<p>Triangles aren’t so readily created, although it is easy to convert a quadmesh version of a raster into triangles.</p>
<p>For polygons, we need specialist code. There are two algorithm types:</p>
<ul>
<li>ear-clipping (or ear-cutting)</li>
<li>near-Delaunay methods</li>
</ul>
<p>The <code>mesh_polys</code> object is create from the <code>two_polys</code> simple features layer using ear-clipping.</p>
<p>This is a very simple algorithm, it chooses one corner of the polygon and clips off a triangle at the next vertex, then proceeds around the boundary - the <code>decido</code> package on CRAN uses the Mapbox library <code>earcut</code> to do this.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">plot</span>(two_polys, <span class="dt">reset =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="kw">polygon</span>(<span class="kw">t</span>(mesh_polys<span class="op">$</span>vb[, <span class="kw">rbind</span>(mesh_polys<span class="op">$</span>it, <span class="ot">NA</span>)]))</a></code></pre></div>
<p><img src="geo-comp-graphics_files/figure-html/ear-clipping-1.png" width="672" /></p>
<p>The <code>delaunay_polys</code> object is created from <code>two_polys</code> using the in-development <code>anglr</code> package, on Github only - anglr uses the <code>RTriangle</code> package from CRAN to do this. All edges in the polygons are fed to the algorithm which creates all constrained triangles, then this mesh of triangles is processed to determine which polygon (or hole) each belongs to. With <code>RTriangle</code> we can also specify properties like maximum triangle area, or “conform to Delaunay criterion”. (This is why we always call polygon triangulation near-Delaunay …).</p>
<p>This mesh is both Delaunay-conforming and applying a maximum triangle area, so extra vertices have been added that weren’t in the original polygons.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">plot</span>(two_polys, <span class="dt">reset =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">polygon</span>(<span class="kw">t</span>(delaunay_polys<span class="op">$</span>vb[, <span class="kw">rbind</span>(delaunay_polys<span class="op">$</span>it, <span class="ot">NA</span>)]))</a></code></pre></div>
<p><img src="geo-comp-graphics_files/figure-html/delaunay-constrained-1.png" width="672" /></p>
</div>
<div id="d-polygons" class="section level2">
<h2><span class="header-section-number">4.3</span> 3D polygons</h2>
<p>If we don’t have triangles (or quads), we can’t plot surfaces or polygons in 3D at all.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">shade3d</span>(mesh_polys)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl54669" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl54669">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"67":{"id":67,"type":"triangles","material":{},"vertices":[[0,0,0],[0.200000002980232,0.200000002980232,0],[0.200000002980232,0.400000005960464,0],[0.5,0.200000002980232,0],[0.200000002980232,0.200000002980232,0],[0,0,0],[0.689999997615814,0,0],[0.800000011920929,0.600000023841858,0],[0.5,0.699999988079071,0],[0.5,0.699999988079071,0],[1,0.800000011920929,0],[0.75,1,0],[0,1,0],[0,0,0],[0.200000002980232,0.400000005960464,0],[0.5,0.200000002980232,0],[0,0,0],[0.689999997615814,0,0],[0.5,0.699999988079071,0],[0.75,1,0],[0,1,0],[0,1,0],[0.200000002980232,0.400000005960464,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.5,0.200000002980232,0],[0.689999997615814,0,0],[0.5,0.699999988079071,0],[0,1,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.689999997615814,0,0],[0.5,0.699999988079071,0],[0.5,0.699999988079071,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.800000011920929,0.600000023841858,0],[0.689999997615814,0,0],[1.23000001907349,0.300000011920929,0],[1.23000001907349,0.300000011920929,0],[1.10000002384186,0.629999995231628,0],[0.800000011920929,0.600000023841858,0]],"normals":[[0,-0,1],[0,-0,1],[0,-0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,-0,1],[0,-0,1],[0,-0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1]],"colors":[[0,0,0,1]],"centers":[[0.133333340287209,0.200000017881393,0],[0.233333334326744,0.133333340287209,0],[0.663333356380463,0.433333337306976,0],[0.75,0.833333373069763,0],[0.0666666701436043,0.466666668653488,0],[0.396666705608368,0.0666666701436043,0],[0.416666686534882,0.900000035762787,0],[0.16666667163372,0.666666686534882,0],[0.56333339214325,0.200000017881393,0],[0.266666680574417,0.766666769981384,0],[0.56333339214325,0.366666674613953,0],[0.433333337306976,0.566666662693024,0],[0.906666696071625,0.300000011920929,0],[1.04333329200745,0.509999990463257,0]],"ignoreExtent":false,"flags":3},"5":{"id":5,"reuse":"rgl47686"},"4":{"id":4,"reuse":"rgl47686"},"6":{"id":6,"reuse":"rgl47686"},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.06239604949951],"modelMatrix":[[1,0,0,-0.615000009536743],[0,0.342020153999329,0.939692616462708,-0.171010076999664],[0,-0.939692616462708,0.342020153999329,-2.5925498008728],[0,0,0,1]],"projMatrix":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370372772217,-11.0395841598511],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,1.23000001907349,0,1,0,0],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,67,5],"subscenes":[],"flags":515},"74":{"id":74,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":74,"sphereVerts":{"reuse":"rgl47686"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<p>But, unless we modify the material properties of the surface, or update the geometry in the 3rd dimension we cannot tell the difference between these different mesh polygons.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">shade3d</span>(delaunay_polys)</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl44837" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl44837">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"75":{"id":75,"type":"triangles","material":{},"vertices":[[0.344999998807907,0,0],[0.5,0.200000002980232,0],[0.200000002980232,0.200000002980232,0],[0.5,0.200000002980232,0],[0.344999998807907,0,0],[0.689999997615814,0,0],[0.200000002980232,0.400000005960464,0],[0,0.5,0],[0,0.25,0],[0,0.5,0],[0.300000011920929,0.600000023841858,0],[0,0.75,0],[0,0.25,0],[0,0,0],[0.200000002980232,0.200000002980232,0],[0.5,0.699999988079071,0],[0.375,1,0],[0.20833332836628,0.791666686534882,0],[0.5,0.699999988079071,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.735081970691681,0.245901644229889,0],[0.5,0.400000005960464,0],[0.5,0.200000002980232,0],[0.5625,1,0],[0.7548548579216,0.750970959663391,0],[0.75,1,0],[0.800000011920929,0.600000023841858,0],[0.5,0.699999988079071,0],[0.5,0.400000005960464,0],[0,0.75,0],[0.20833332836628,0.791666686534882,0],[0,1,0],[0.300000011920929,0.600000023841858,0],[0,0.5,0],[0.200000002980232,0.400000005960464,0],[0.200000002980232,0.200000002980232,0],[0,0,0],[0.344999998807907,0,0],[0.7548548579216,0.750970959663391,0],[1,0.800000011920929,0],[0.75,1,0],[0.5,0.699999988079071,0],[0.5625,1,0],[0.375,1,0],[0.5,0.200000002980232,0],[0.689999997615814,0,0],[0.735081970691681,0.245901644229889,0],[0.200000002980232,0.400000005960464,0],[0,0.25,0],[0.200000002980232,0.200000002980232,0],[0.5,0.400000005960464,0],[0.735081970691681,0.245901644229889,0],[0.800000011920929,0.600000023841858,0],[0.20833332836628,0.791666686534882,0],[0.375,1,0],[0.25,1,0],[0.20833332836628,0.791666686534882,0],[0.300000011920929,0.600000023841858,0],[0.5,0.699999988079071,0],[0.7548548579216,0.750970959663391,0],[0.5625,1,0],[0.5,0.699999988079071,0],[0.300000011920929,0.600000023841858,0],[0.20833332836628,0.791666686534882,0],[0,0.75,0],[0,1,0],[0.20833332836628,0.791666686534882,0],[0.25,1,0],[0.972580194473267,0.389198243618011,0],[0.735081970691681,0.245901644229889,0],[0.908539295196533,0.121410734951496,0],[0.735081970691681,0.245901644229889,0],[0.689999997615814,0,0],[0.908539295196533,0.121410734951496,0],[0.972580194473267,0.389198243618011,0],[1.10000002384186,0.629999995231628,0],[0.800000011920929,0.600000023841858,0],[0.735081970691681,0.245901644229889,0],[0.972580194473267,0.389198243618011,0],[0.800000011920929,0.600000023841858,0],[1.10000002384186,0.629999995231628,0],[0.972580194473267,0.389198243618011,0],[1.23000001907349,0.300000011920929,0],[0.908539295196533,0.121410734951496,0],[1.23000001907349,0.300000011920929,0],[0.972580194473267,0.389198243618011,0]],"normals":[[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,-0,1],[0,-0,1],[0,-0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,-0,1],[0,-0,1],[0,-0,1],[0,0,1],[0,0,1],[0,0,1],[0,-0,1],[0,-0,1],[0,-0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,-0,1],[0,-0,1],[0,-0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,1],[0,0,1],[0,0,1]],"colors":[[0,0,0,1]],"centers":[[0.348333358764648,0.133333340287209,0],[0.511666715145111,0.0666666701436043,0],[0.0666666701436043,0.383333325386047,0],[0.100000008940697,0.616666674613953,0],[0.0666666701436043,0.150000005960464,0],[0.361111134290695,0.830555617809296,0],[0.433333337306976,0.566666662693024,0],[0.578360676765442,0.281967222690582,0],[0.689118325710297,0.916990280151367,0],[0.600000023841858,0.566666662693024,0],[0.0694444477558136,0.84722226858139,0],[0.16666667163372,0.5,0],[0.181666672229767,0.0666666701436043,0],[0.834951639175415,0.850323677062988,0],[0.479166686534882,0.900000035762787,0],[0.641694009304047,0.148633882403374,0],[0.133333340287209,0.283333331346512,0],[0.678360641002655,0.415300577878952,0],[0.277777791023254,0.930555582046509,0],[0.336111128330231,0.697222232818604,0],[0.605785012245178,0.816990315914154,0],[0.169444441795349,0.713888883590698,0],[0.152777776122093,0.930555582046509,0],[0.872067153453827,0.252170205116272,0],[0.777873754501343,0.122437462210655,0],[0.957526803016663,0.539732754230499,0],[0.835887372493744,0.41169998049736,0],[1.10086011886597,0.439732730388641,0],[1.03703987598419,0.270202994346619,0]],"ignoreExtent":false,"flags":3},"5":{"id":5,"reuse":"rgl47686"},"4":{"id":4,"reuse":"rgl47686"},"6":{"id":6,"reuse":"rgl47686"},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.06239604949951],"modelMatrix":[[1,0,0,-0.615000009536743],[0,0.342020153999329,0.939692616462708,-0.171010076999664],[0,-0.939692616462708,0.342020153999329,-2.5925498008728],[0,0,0,1]],"projMatrix":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370372772217,-11.0395841598511],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,1.23000001907349,0,1,0,0],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,75,5],"subscenes":[],"flags":515},"82":{"id":82,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":82,"sphereVerts":{"reuse":"rgl47686"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<p>Let’s push the Delaunay version up in Z and add some noise.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">delaunay_polys<span class="op">$</span>vb[<span class="dv">3</span>,] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3">delaunay_polys<span class="op">$</span>vb[<span class="dv">3</span>,] &lt;-<span class="st"> </span>delaunay_polys<span class="op">$</span>vb[<span class="dv">3</span>,] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="st">    </span><span class="kw">runif</span>(<span class="kw">ncol</span>(delaunay_polys<span class="op">$</span>vb), <span class="dv">1</span>, <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="kw">shade3d</span>(mesh_polys, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="kw">wire3d</span>(delaunay_polys)</a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl94449" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl94449">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"83":{"id":83,"type":"triangles","material":{},"vertices":[[0,0,0],[0.200000002980232,0.200000002980232,0],[0.200000002980232,0.400000005960464,0],[0.5,0.200000002980232,0],[0.200000002980232,0.200000002980232,0],[0,0,0],[0.689999997615814,0,0],[0.800000011920929,0.600000023841858,0],[0.5,0.699999988079071,0],[0.5,0.699999988079071,0],[1,0.800000011920929,0],[0.75,1,0],[0,1,0],[0,0,0],[0.200000002980232,0.400000005960464,0],[0.5,0.200000002980232,0],[0,0,0],[0.689999997615814,0,0],[0.5,0.699999988079071,0],[0.75,1,0],[0,1,0],[0,1,0],[0.200000002980232,0.400000005960464,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.5,0.200000002980232,0],[0.689999997615814,0,0],[0.5,0.699999988079071,0],[0,1,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.689999997615814,0,0],[0.5,0.699999988079071,0],[0.5,0.699999988079071,0],[0.300000011920929,0.600000023841858,0],[0.5,0.400000005960464,0],[0.800000011920929,0.600000023841858,0],[0.689999997615814,0,0],[1.23000001907349,0.300000011920929,0],[1.23000001907349,0.300000011920929,0],[1.10000002384186,0.629999995231628,0],[0.800000011920929,0.600000023841858,0]],"normals":[[0,-0,1],[0,-0,1],[0,-0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,-0,1],[0,-0,1],[0,-0,1],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[0,0,0.999999940395355],[-0,0,1],[-0,0,1],[-0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1]],"colors":[[0.745098054409027,0.745098054409027,0.745098054409027,1]],"centers":[[0.133333340287209,0.200000017881393,0],[0.233333334326744,0.133333340287209,0],[0.663333356380463,0.433333337306976,0],[0.75,0.833333373069763,0],[0.0666666701436043,0.466666668653488,0],[0.396666705608368,0.0666666701436043,0],[0.416666686534882,0.900000035762787,0],[0.16666667163372,0.666666686534882,0],[0.56333339214325,0.200000017881393,0],[0.266666680574417,0.766666769981384,0],[0.56333339214325,0.366666674613953,0],[0.433333337306976,0.566666662693024,0],[0.906666696071625,0.300000011920929,0],[1.04333329200745,0.509999990463257,0]],"ignoreExtent":false,"flags":3},"84":{"id":84,"type":"triangles","material":{"front":"lines","back":"lines"},"vertices":[[0.344999998807907,0,1.24385130405426],[0.5,0.200000002980232,1.00900948047638],[0.200000002980232,0.200000002980232,1.1028733253479],[0.5,0.200000002980232,1.00900948047638],[0.344999998807907,0,1.24385130405426],[0.689999997615814,0,1.16922795772552],[0.200000002980232,0.400000005960464,1.06509625911713],[0,0.5,1.20075213909149],[0,0.25,1.27827179431915],[0,0.5,1.20075213909149],[0.300000011920929,0.600000023841858,1.19512569904327],[0,0.75,1.40566754341125],[0,0.25,1.27827179431915],[0,0,1.41651928424835],[0.200000002980232,0.200000002980232,1.1028733253479],[0.5,0.699999988079071,1.03863346576691],[0.375,1,1.09460175037384],[0.20833332836628,0.791666686534882,1.08860445022583],[0.5,0.699999988079071,1.03863346576691],[0.300000011920929,0.600000023841858,1.19512569904327],[0.5,0.400000005960464,1.01835453510284],[0.735081970691681,0.245901644229889,1.34478044509888],[0.5,0.400000005960464,1.01835453510284],[0.5,0.200000002980232,1.00900948047638],[0.5625,1,1.48452198505402],[0.7548548579216,0.750970959663391,1.10755097866058],[0.75,1,1.45165705680847],[0.800000011920929,0.600000023841858,1.14390003681183],[0.5,0.699999988079071,1.03863346576691],[0.5,0.400000005960464,1.01835453510284],[0,0.75,1.40566754341125],[0.20833332836628,0.791666686534882,1.08860445022583],[0,1,1.0625809431076],[0.300000011920929,0.600000023841858,1.19512569904327],[0,0.5,1.20075213909149],[0.200000002980232,0.400000005960464,1.06509625911713],[0.200000002980232,0.200000002980232,1.1028733253479],[0,0,1.41651928424835],[0.344999998807907,0,1.24385130405426],[0.7548548579216,0.750970959663391,1.10755097866058],[1,0.800000011920929,1.24075949192047],[0.75,1,1.45165705680847],[0.5,0.699999988079071,1.03863346576691],[0.5625,1,1.48452198505402],[0.375,1,1.09460175037384],[0.5,0.200000002980232,1.00900948047638],[0.689999997615814,0,1.16922795772552],[0.735081970691681,0.245901644229889,1.34478044509888],[0.200000002980232,0.400000005960464,1.06509625911713],[0,0.25,1.27827179431915],[0.200000002980232,0.200000002980232,1.1028733253479],[0.5,0.400000005960464,1.01835453510284],[0.735081970691681,0.245901644229889,1.34478044509888],[0.800000011920929,0.600000023841858,1.14390003681183],[0.20833332836628,0.791666686534882,1.08860445022583],[0.375,1,1.09460175037384],[0.25,1,1.45892477035522],[0.20833332836628,0.791666686534882,1.08860445022583],[0.300000011920929,0.600000023841858,1.19512569904327],[0.5,0.699999988079071,1.03863346576691],[0.7548548579216,0.750970959663391,1.10755097866058],[0.5625,1,1.48452198505402],[0.5,0.699999988079071,1.03863346576691],[0.300000011920929,0.600000023841858,1.19512569904327],[0.20833332836628,0.791666686534882,1.08860445022583],[0,0.75,1.40566754341125],[0,1,1.0625809431076],[0.20833332836628,0.791666686534882,1.08860445022583],[0.25,1,1.45892477035522],[0.972580194473267,0.389198243618011,1.15998244285583],[0.735081970691681,0.245901644229889,1.34478044509888],[0.908539295196533,0.121410734951496,1.15013086795807],[0.735081970691681,0.245901644229889,1.34478044509888],[0.689999997615814,0,1.16922795772552],[0.908539295196533,0.121410734951496,1.15013086795807],[0.972580194473267,0.389198243618011,1.15998244285583],[1.10000002384186,0.629999995231628,1.13229858875275],[0.800000011920929,0.600000023841858,1.14390003681183],[0.735081970691681,0.245901644229889,1.34478044509888],[0.972580194473267,0.389198243618011,1.15998244285583],[0.800000011920929,0.600000023841858,1.14390003681183],[1.10000002384186,0.629999995231628,1.13229858875275],[0.972580194473267,0.389198243618011,1.15998244285583],[1.23000001907349,0.300000011920929,1.30953574180603],[0.908539295196533,0.121410734951496,1.15013086795807],[1.23000001907349,0.300000011920929,1.30953574180603],[0.972580194473267,0.389198243618011,1.15998244285583]],"normals":[[0.223143503069878,0.664501667022705,0.713193118572235],[0.223143503069878,0.664501667022705,0.713193118572235],[0.223143503069878,0.664501667022705,0.713193118572235],[0.15070366859436,0.701318323612213,0.696735918521881],[0.15070366859436,0.701318323612213,0.696735918521881],[0.15070366859436,0.701318323612213,0.696735918521881],[0.622752726078033,0.231726840138435,0.747316420078278],[0.622752726078033,0.231726840138435,0.747316420078278],[0.622752726078033,0.231726840138435,0.747316420078278],[0.220266625285149,-0.61835378408432,0.75440126657486],[0.220266625285149,-0.61835378408432,0.75440126657486],[0.220266625285149,-0.61835378408432,0.75440126657486],[0.664178490638733,0.36177071928978,0.654208481311798],[0.664178490638733,0.36177071928978,0.654208481311798],[0.664178490638733,0.36177071928978,0.654208481311798],[0.127503886818886,-0.130307734012604,0.983240902423859],[0.127503886818886,-0.130307734012604,0.983240902423859],[0.127503886818886,-0.130307734012604,0.983240902423859],[0.631480038166046,-0.0522944182157516,0.773626685142517],[0.631480038166046,-0.0522944182157516,0.773626685142517],[0.631480038166046,-0.0522944182157516,0.773626685142517],[-0.817155241966248,-0.0269039198756218,0.575789511203766],[-0.817155241966248,-0.0269039198756218,0.575789511203766],[-0.817155241966248,-0.0269039198756218,0.575789511203766],[0.102388300001621,-0.805167019367218,0.584142684936523],[0.102388300001621,-0.805167019367218,0.584142684936523],[0.102388300001621,-0.805167019367218,0.584142684936523],[-0.349126666784286,-0.0631987527012825,0.934941947460175],[-0.349126666784286,-0.0631987527012825,0.934941947460175],[-0.349126666784286,-0.0631987527012825,0.934941947460175],[0.592044055461884,0.651328921318054,0.474609732627869],[0.592044055461884,0.651328921318054,0.474609732627869],[0.592044055461884,0.651328921318054,0.474609732627869],[0.216322883963585,-0.605894267559052,0.765569448471069],[0.216322883963585,-0.605894267559052,0.765569448471069],[0.216322883963585,-0.605894267559052,0.765569448471069],[0.32370001077652,0.690584301948547,0.646770179271698],[0.32370001077652,0.690584301948547,0.646770179271698],[0.32370001077652,0.690584301948547,0.646770179271698],[-0.153712004423141,-0.80151230096817,0.577884554862976],[-0.153712004423141,-0.80151230096817,0.577884554862976],[-0.153712004423141,-0.80151230096817,0.577884554862976],[-0.819878160953522,-0.415168046951294,0.394252836704254],[-0.819878160953522,-0.415168046951294,0.394252836704254],[-0.819878160953522,-0.415168046951294,0.394252836704254],[-0.770915985107422,-0.270379662513733,0.576700568199158],[-0.770915985107422,-0.270379662513733,0.576700568199158],[-0.770915985107422,-0.270379662513733,0.576700568199158],[0.672293484210968,0.13739937543869,0.727422058582306],[0.672293484210968,0.13739937543869,0.727422058582306],[0.672293484210968,0.13739937543869,0.727422058582306],[-0.590547978878021,0.477386116981506,0.650657892227173],[-0.590547978878021,0.477386116981506,0.650657892227173],[-0.590547978878021,0.477386116981506,0.650657892227173],[0.750878572463989,-0.608119308948517,0.257628053426743],[0.750878572463989,-0.608119308948517,0.257628053426743],[0.750878572463989,-0.608119308948517,0.257628053426743],[0.309673875570297,0.570755481719971,0.760486900806427],[0.309673875570297,0.570755481719971,0.760486900806427],[0.309673875570297,0.570755481719971,0.760486900806427],[0.0155903268605471,-0.830598771572113,0.556653141975403],[0.0155903268605471,-0.830598771572113,0.556653141975403],[0.0155903268605471,-0.830598771572113,0.556653141975403],[0.641357779502869,0.583566069602966,0.498107343912125],[0.641357779502869,0.583566069602966,0.498107343912125],[0.641357779502869,0.583566069602966,0.498107343912125],[-0.667187094688416,-0.614618957042694,0.420838564634323],[-0.667187094688416,-0.614618957042694,0.420838564634323],[-0.667187094688416,-0.614618957042694,0.420838564634323],[0.671032786369324,-0.186871945858002,0.717491447925568],[0.671032786369324,-0.186871945858002,0.717491447925568],[0.671032786369324,-0.186871945858002,0.717491447925568],[0.385818630456924,-0.581859409809113,0.715949535369873],[0.385818630456924,-0.581859409809113,0.715949535369873],[0.385818630456924,-0.581859409809113,0.715949535369873],[0.0285398531705141,0.0992488339543343,0.994653284549713],[0.0285398531705141,0.0992488339543343,0.994653284549713],[0.0285398531705141,0.0992488339543343,0.994653284549713],[0.404424786567688,0.394061505794525,0.825321853160858],[0.404424786567688,0.394061505794525,0.825321853160858],[0.404424786567688,0.394061505794525,0.825321853160858],[-0.395551085472107,0.308749377727509,0.864993214607239],[-0.395551085472107,0.308749377727509,0.864993214607239],[-0.395551085472107,0.308749377727509,0.864993214607239],[-0.479126483201981,0.082433745265007,0.873866379261017],[-0.479126483201981,0.082433745265007,0.873866379261017],[-0.479126483201981,0.082433745265007,0.873866379261017]],"colors":[[0,0,0,1]],"centers":[[0.348333358764648,0.133333340287209,1.11857807636261],[0.511666715145111,0.0666666701436043,1.14069628715515],[0.0666666701436043,0.383333325386047,1.18137347698212],[0.100000008940697,0.616666674613953,1.26718187332153],[0.0666666701436043,0.150000005960464,1.26588821411133],[0.361111134290695,0.830555617809296,1.07394659519196],[0.433333337306976,0.566666662693024,1.0840380191803],[0.578360676765442,0.281967222690582,1.12404811382294],[0.689118325710297,0.916990280151367,1.34790992736816],[0.600000023841858,0.566666662693024,1.06696271896362],[0.0694444477558136,0.84722226858139,1.18561768531799],[0.16666667163372,0.5,1.15365815162659],[0.181666672229767,0.0666666701436043,1.25441455841064],[0.834951639175415,0.850323677062988,1.26665592193604],[0.479166686534882,0.900000035762787,1.20591914653778],[0.641694009304047,0.148633882403374,1.17433929443359],[0.133333340287209,0.283333331346512,1.14874720573425],[0.678360641002655,0.415300577878952,1.16901159286499],[0.277777791023254,0.930555582046509,1.21404361724854],[0.336111128330231,0.697222232818604,1.10745453834534],[0.605785012245178,0.816990315914154,1.21023547649384],[0.169444441795349,0.713888883590698,1.22979927062988],[0.152777776122093,0.930555582046509,1.20337009429932],[0.872067153453827,0.252170205116272,1.21829795837402],[0.777873754501343,0.122437462210655,1.22137975692749],[0.957526803016663,0.539732754230499,1.1453937292099],[0.835887372493744,0.41169998049736,1.21622109413147],[1.10086011886597,0.439732730388641,1.20060563087463],[1.03703987598419,0.270202994346619,1.2065497636795]],"ignoreExtent":false,"flags":3},"5":{"id":5,"reuse":"rgl47686"},"4":{"id":4,"reuse":"rgl47686"},"6":{"id":6,"reuse":"rgl47686"},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,4.19559097290039],"modelMatrix":[[1,0,0,-0.615000009536743],[0,0.342020153999329,0.939692616462708,-0.868507266044617],[0,-0.939692616462708,0.342020153999329,-3.97961282730103],[0,0,0,1]],"projMatrix":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370325088501,-15.1246194839478],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,1.23000001907349,0,1,0,1.48452198505402],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,83,84,5],"subscenes":[],"flags":515},"91":{"id":91,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":91,"sphereVerts":{"reuse":"rgl47686"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<p>The primary means to create this format from a raster is for 3D plotting, but because we have access to the coordinate directly it provides other uses. We can transform the coordinates (i.e. a map projection) or manipulate them and augment the Z value (for example) in flexible ways.</p>
<p>(The usual way of driving rgl grid surfaces is <code>rgl.surface</code> but this is limited to the centre-point interpretation only - more than the x, y, z list interface as image() is, i.e. it can take an individual x,y pair for every cell, but it cannot properly represent the cell-as-area as image can. For this we need to use <code>shade3d</code>, and actual <code>meshd3d</code> types in <code>rgl</code>).</p>
</div>
<div id="rgl-miscellanea" class="section level2">
<h2><span class="header-section-number">4.4</span> rgl miscellanea</h2>
<p>Most examples around use <code>rgl.surface</code>, but I am less familiar with that. The <code>thing3d()</code> are the higher-level functions in rgl, and the <code>rgl.thing()</code> functions are lower-level (recommended not to mix them in usage).</p>
<p><strong>rayshader</strong> in particular, has extremely compelling outputs, but it uses the lower level <code>rgl.surface</code> and doesn’t maintain the geographic coordinates, so I see it mostly as a texture-generator (but watch its development!).</p>
<p><strong>rgl.surface</strong> can take X and Y <em>matrices</em>, so you can trivially reproject these data
and wrap them around a sphere - I only learnt this recently.</p>
<p><strong>WATCH OUT</strong></p>
<p>The single most confusing thing I found with <code>mesh3d</code> was <em>homogeneous coordinates</em>. This is a fourth value on each vertex, making it <code>X, Y, Z, H</code> and because it’s stored transpose, the <code>ib</code> and the <code>vb</code> matrices have the same number of rows (4). The <code>H</code> loosely corresponds to “zoom”, for our purposes set <code>H = 1</code>. (If set to 0 no data will be visible, and a package of mine had this bug until last week.)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="d-and-mesh-forms-of-spatial-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transforming-spatial-data-to-3d-forms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mdsumner/geo-comp-graphics-oghub/edit/master/03_rgl_package.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
